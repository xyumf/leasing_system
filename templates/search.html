<!DOCTYPE html>
<html>
<head> 
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>爱家-房源</title>
    <link href="/static/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="/static/css/reset.css" rel="stylesheet">
    <link href="/static/plugins/bootstrap-datepicker/css/bootstrap-datepicker.min.css" rel="stylesheet">
    <link href="/static/css/ihome/main.css" rel="stylesheet">
    <link href="/static/css/ihome/search.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="top-bar">
            <div class="nav-bar">
                <h3 class="page-title">房 源</h3>
                <a class="nav-btn fl" href="{{ url_for('home.index')}}"><span><i class="fa fa-angle-left fa-2x"></i></span></a>
            </div>
            <ul class="filter-title-bar">
                <li class="filter-title">
                    <span>入住日期</span>
                    <span><i class="fa fa-angle-down"></i></span>
                    <span class="split-line fr">|</span>
                </li>
                <li class="filter-title">
                    <span>位置区域</span>
                    <span><i class="fa fa-angle-down"></i></span>
                    <span class="split-line fr">|</span>
                </li>
                <li class="filter-title">
                    <span id="search">最新上线</span>
                    <span><i class="fa fa-angle-down"></i></span>
                </li>
            </ul>
            <div class="filter-item-bar">
                <div class="filter-item filter-date">
                    <div class="input-daterange input-group">
                        <input type="text" class="input-sm form-control" id="start-date" />
                        <span class="input-group-addon">至</span>
                        <input type="text" class="input-sm form-control" id="end-date" />
                    </div>
                </div>
                <ul class="filter-item filter-area" id="area_list" >
                </ul>
                <ul class="filter-item filter-sort" id="11">
                    <li class="active" sort-key="new">最新上线</li>
                    <li sort-key="booking">入住最多</li>
                    <li sort-key="price-inc">价格 低-高</li>
                    <li sort-key="price-des">价格 高-低</li>
                </ul>
            </div>
        </div>
        <div class="display-mask"></div>
        <ul class="house-list">

        </ul>
        <div class="footer">
            <p><span><i class="fa fa-copyright"></i></span>爱家租房&nbsp;&nbsp;享受家的温馨</p>
        </div>
    </div>
    
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/plugins/bootstrap/js/bootstrap.min.js"></script>
    <script src="/static/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js"></script>
    <script src="/static/plugins/bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN.min.js"></script>
    <script src="/static/js/template.js"></script>
    <script src="/static/js/ihome/search.js"></script>
    <script>

        $.ajax({
            url: '/home/search/',
            type: 'POST',
            dataType: 'json',
            success: function(data){
                var areas = data.areas
                for(var i=0; i<areas.length; i++){
                    var area = '<li area-id="' + areas[i].id + '">' + areas[i].name + '</li>'
                    $('#area_list').append(area)
                }
            }
        })

        sear()
        function sear(){
            var queryData = decodeQuery()
            var areaName = queryData["aname"];
            var startDate = queryData["sd"];
            var endDate = queryData["ed"];
            var now = $('#search').html();
            $.ajax({
                url: '/home/search11/',
                type: 'POST',
                dataType: 'json',
                data: {'startDate':startDate, 'endDate':endDate, 'areaName':areaName, 'now':now},
                success: function(data){
                    $('.house-item').hide()
                    var houses = data.house_dic
                    console.log(houses)
                    for(var i=0; i<houses.length; i++){
                        var house_info = '<li class="house-item"><a href="/home/detail?id=' + houses[i].id + '"><img src="/static/media/' + houses[i].images + '"></a>'
                        house_info += '<div class="house-desc"><div class="house-price">￥<span>' + houses[i].price + '</span>/晚</div>'
                        house_info += '<div class="house-intro"><span class="house-title">' + houses[i].title + '</span><em>出租' + houses[i].room_count + '间 - 1次入住 - '
                        house_info +=  houses[i].address + '</em></div></div></li>'
                        console.log(house_info)
                        $('.house-list').append(house_info)
                    }

                }

            })
        }

    </script>
</body>
</html>